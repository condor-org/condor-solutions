openapi: 3.0.0
info:
  title: Condor API
  version: "1.2"
paths:
  # üîê AUTH
  /api/auth/registro/:
    post:
      summary: Registro de nuevo alumno
      description: Registra un nuevo usuario con tipo jugador.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
                username:
                  type: string
                  nullable: true
                telefono:
                  type: string
                  nullable: true
              required:
                - email
                - password
      responses:
        "201":
          description: Registro exitoso
      tags: [Auth]

  /api/token/:
    post:
      summary: Login JWT
      description: Obtener access y refresh token.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password
      responses:
        "200":
          description: Tokens devueltos
      tags: [Auth]

  /api/token/refresh/:
    post:
      summary: Refresh token JWT
      description: Refresca un access token usando refresh token.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh:
                  type: string
              required:
                - refresh
      responses:
        "200":
          description: Nuevo token
      tags: [Auth]

  /api/auth/yo/:
    get:
      summary: Perfil propio
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Datos del usuario logueado
      tags: [Auth]

  # üè¢ Sedes
  /api/turnos/sedes/:
    get:
      summary: Listar sedes
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de sedes
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
      tags: [Sedes]

  # üéæ Turnos core
  /api/turnos/turnos/:
    get:
      summary: Listar todos los turnos
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de turnos
      tags: [Turnos]

  /api/turnos/turnos/disponibles/:
    get:
      summary: Turnos disponibles
      description: Filtra por `lugar_id`, `profesor_id` y opcionalmente `fecha`.
      parameters:
        - in: query
          name: lugar_id
          required: true
          schema:
            type: integer
        - in: query
          name: profesor_id
          required: true
          schema:
            type: integer
        - in: query
          name: fecha
          required: false
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Lista de turnos libres
      tags: [Turnos]

  /api/turnos/turnos/reservar/:
    post:
      summary: Reservar turno con comprobante
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                turno_id:
                  type: integer
                archivo:
                  type: string
                  format: binary
              required:
                - turno_id
                - archivo
      responses:
        "200":
          description: Reserva exitosa
      tags: [Turnos]

    # üìÑ Comprobantes
  /api/comprobantes/:
    post:
      summary: Subir comprobante de pago
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                turno_id:
                  type: integer
                archivo:
                  type: string
                  format: binary
              required:
                - turno_id
                - archivo
      responses:
        "201":
          description: Comprobante registrado
      tags: [Comprobantes]

    get:
      summary: Listar comprobantes
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de comprobantes
      tags: [Comprobantes]

  /api/comprobantes/{id}/descargar/:
    get:
      summary: Descargar comprobante
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Archivo PDF o imagen del comprobante
          content:
            application/octet-stream: {}
      tags: [Comprobantes]

  /api/comprobantes/{id}/aprobar/:
    patch:
      summary: Aprobar comprobante
      description: Permite al admin aprobar un comprobante de pago. Cambia el estado a v√°lido.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Comprobante aprobado
          content:
            application/json:
              schema:
                type: object
                properties:
                  mensaje:
                    type: string
      tags: [Comprobantes]

  /api/comprobantes/{id}/rechazar/:
    patch:
      summary: Rechazar comprobante
      description: Permite al admin rechazar un comprobante de pago. Marca como inv√°lido y libera el turno.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Comprobante rechazado y turno liberado
          content:
            application/json:
              schema:
                type: object
                properties:
                  mensaje:
                    type: string
      tags: [Comprobantes]


  # üßë‚Äçüè´ Turnos Padel
  /api/padel/profesores-disponibles/:
    get:
      summary: Listar profesores disponibles
      parameters:
        - in: query
          name: lugar_id
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Profesores con turnos libres
      tags: [Padel]

  /api/padel/profesores/{id}/disponibilidades/:
    get:
      summary: Ver disponibilidades de profesor
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de disponibilidades
      tags: [Padel]

  /api/padel/generar-turnos/:
    post:
      summary: Generar turnos del mes
      description: Genera turnos a partir de disponibilidades activas de profesores.
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                anio:
                  type: integer
                mes:
                  type: integer
                duracion_minutos:
                  type: integer
                profesor_id:
                  type: integer
              required:
                - anio
                - mes
      responses:
        "200":
          description: Turnos generados
      tags: [Padel]

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

      